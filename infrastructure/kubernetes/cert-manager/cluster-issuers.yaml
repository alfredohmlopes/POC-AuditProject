---
# Namespace: cert-manager
apiVersion: v1
kind: Namespace
metadata:
  name: cert-manager
  labels:
    app.kubernetes.io/name: cert-manager
---
# Note: For production, install cert-manager via Helm for easier updates:
# helm repo add jetstack https://charts.jetstack.io
# helm install cert-manager jetstack/cert-manager --namespace cert-manager --set installCRDs=true

# This file provides a basic setup for self-signed certificates (development)
# and Let's Encrypt (production)

---
# ClusterIssuer: Self-Signed (for development/internal)
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: selfsigned-issuer
spec:
  selfSigned: {}
---
# ClusterIssuer: Let's Encrypt Staging (for testing)
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-staging
spec:
  acme:
    # Email for Let's Encrypt notifications
    email: platform@magalu.com  # TODO: Update with real email
    server: https://acme-staging-v02.api.letsencrypt.org/directory
    privateKeySecretRef:
      name: letsencrypt-staging-key
    solvers:
      - http01:
          ingress:
            class: nginx
---
# ClusterIssuer: Let's Encrypt Production
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
spec:
  acme:
    email: platform@magalu.com  # TODO: Update with real email
    server: https://acme-v02.api.letsencrypt.org/directory
    privateKeySecretRef:
      name: letsencrypt-prod-key
    solvers:
      - http01:
          ingress:
            class: nginx
---
# Certificate: Turia Trails Wildcard (example)
# Uncomment and configure when domain is ready
# apiVersion: cert-manager.io/v1
# kind: Certificate
# metadata:
#   name: turia-trails-tls
#   namespace: turia-trails
# spec:
#   secretName: turia-trails-tls
#   issuerRef:
#     name: letsencrypt-prod
#     kind: ClusterIssuer
#   commonName: "*.turia.magalu.cloud"
#   dnsNames:
#     - "turia.magalu.cloud"
#     - "*.turia.magalu.cloud"
#     - "api.turia.magalu.cloud"
#     - "dashboard.turia.magalu.cloud"
